{{- /*  Initialize. */}}
{{- $asset := "" }}

{{- /* Get params. */}}
{{- with (.Get 0) }}
  {{- $asset = . }}
{{- else }}
  {{- errorf "The %q shortcode requires a single positional parameter; the relative path to a file in the assets directory. See %s" .Name .Position}}
{{- end }}

{{- /* Remove leading slash if present, as resources.Get expects paths relative to assets without leading slash */}}
{{- $asset = $asset | strings.TrimPrefix "/" }}

{{- /* Get resource (validates path exists). */}}
{{- $r := "" }}
{{- with resources.Get $asset }}
  {{- $r = . }}
{{- else }}
  {{- errorf "The %q shortcode was unable to find %q. See %s" .Name $asset .Position}}
{{- end }}

{{- /* Read content via readFile to avoid slice bounds issues with large assets in RenderString. */}}
{{- $assetPath := path.Join "assets" $asset }}
{{- $content := readFile $assetPath }}
{{- if eq $content "" }}
  {{- errorf "The %q shortcode read empty content from %q. See %s" .Name $assetPath .Position}}
{{- end }}

{{- /* Render content. */}}
{{- $content | .Page.RenderString | chomp }}

{{- /* Chomp trailing newlines. */ -}}